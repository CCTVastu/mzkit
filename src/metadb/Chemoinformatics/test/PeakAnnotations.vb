Imports BioNovoGene.Analytical.MassSpectrometry.Math
Imports BioNovoGene.Analytical.MassSpectrometry.Math.Spectra

Module PeakAnnotationsTest

    Const test As String = "
comment  intensity         mz
1        25.7283916473389  180.870544433594
2        33.7242889404297  172.046737670898
3        22.9251556396484  171.146041870117
4        42.3336372375488  168.888076782227
5        14.0657072067261  166.797012329102
6        12.34898853302    156.450942993164
7        55.6221122741699  155.815612792969
8        27.2233371734619  154.217514038086
9        246.935852050781  153.059127807617
10       21.0233592987061  148.453063964844
11       7.12025260925293  144.220184326172
12       13.2232646942139  137.01887512207
13       7.12140130996704  134.552780151367
14       48.390438079834   131.061614990234
15       244.862274169922  126.195465087891
16       9.71616744995117  121.384506225586
17       38.7442741394043  111.493713378906
18       16.1689929962158  109.627792358398
19       27.6699886322021  109.0263671875
20       11.827618598938   107.208969116211
21       31.4417247772217  101.32096862793
22       15.8407869338989  100.265228271484
23       10.1715230941772  98.4160461425781
24       77.7007293701172  90.3216857910156
25       1538.97094726563  89.2855224609375
26       30.3093376159668  85.1649169921875
27       37.993709564209   83.238037109375
28       20.2313117980957  81.4897918701172
29       67.8261795043945  73.2232437133789
30       261.555450439453  72.1920623779297
31       10.1659231185913  67.1925811767578
32       15.130786895752   57.4151573181152
"

    Sub Main()

        Dim precursor As Double = 171.793563842773
        Dim charge As Double = 1
        Dim products As ms2() = test.Trim() _
            .LineTokens _
            .Skip(1) _
            .Select(Function(a) a.StringSplit("\s+")) _
            .Select(Function(a) New ms2 With {.mz = Val(a(2)), .intensity = Val(a(1))}) _
            .ToArray

        Dim result = New PeakAnnotation().RunAnnotations(precursor, products, charge)

        Pause()
    End Sub
End Module
