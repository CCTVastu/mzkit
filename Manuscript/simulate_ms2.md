# 质谱二级碎片模拟

对于任意一种化合物，都是由若干个官能团（原子基团），构成的。这些原子基团之间通过化学键连接，形成了整个化合物的分子。不同的化学键的能量大小不一样，这也就意味着这些化学键断裂所需要的最小的能量是不一样的。对于二级质谱而言，其最基本的工作原理就是通过离子轰击化合物分子，给与化学键的断裂能量，将整个分子通过轰击碎裂化为不同的原子基团，这些分子基团由于所组成的原子的数量以及种类不完全相同，故而他们的分子的质量也不尽相同，故而在磁场之中的飞行的时间也不尽相同。故而通过二级质谱可以通过飞行时间来计算出基团的``m/z``，通过这些计算出来的基团质量``m/z``的分布情况来了解分子的结构或者将这些``m/z``分布作为化合物分子的一种特征进行二级质谱比较来完成物质的鉴定。

## 使用图理论模拟二级质谱碎片

假设我们现在对分子化合物进行简化处理，将原子基团之间的化学键定义为图之中的边，将图之中的节点定义为一个需要很大的能量才能够进行分割的分子基团，那么一个分子化合物就可以看作为一个由原子基团，以及基团之间的化学键所构成的网络。那么二级质谱之中的碎片化的过程就可以看作为网络如何断裂为独立的子网络模块的过程。

我们假设将二级质谱之中的碎片化阶段的分子碰撞的过程看作为一个概率过程，则网络之中的边的断裂则可以看作为一个``[0-1]``的概率区间内所发生的事件。化学键断裂所需要的能量越低，则其发生断裂的概率就越高，则该化学键所连接的两个原子基团相互分离的概率也就越高。即整个分子化合物分裂碎片化为两个``m/z``大小的碎片的概率也就越高。这就表现为这两个``m/z``分子碎片的二级质谱之中相对应的``intensity``响应度值越高。

![](./chemical_graph.jpg)

## 模拟质谱二级碎片所要解决的问题

基于图理论进行质谱二级碎片的模拟之中，所需要解决的问题有：

1. 化学键边的断裂将会将图网络分割为哪些子网络？即化学键的断裂将会产生哪些``m/z``分子质量的分子碎片？
2. 如何将断裂能量转换为断裂的概率高低？即如果从键的断裂能量转换为相应所产生的``m/z``的分子碎片的``intensity``响应度值？
